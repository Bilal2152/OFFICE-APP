<!DOCTYPE html>
<html>
<head>
<title>Office App</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
  --bg-light: #f2f2f2;
  --bg-dark: #1e1e2f;
  --card-light: #ffffff;
  --card-dark: #2b2b3c;
  --text-light: #111;
  --text-dark: #eee;
  --subtext-light: #555;
  --subtext-dark: #bbb;
  --primary: #4f46e5;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --hover-light: #e2e8f0;
  --hover-dark: #3b3b50;
}

body {
  font-family: Arial, sans-serif;
  background: var(--bg-light);
  color: var(--text-light);
  padding: 20px;
  transition: background 0.3s, color 0.3s;
}

.card {
  background: var(--card-light);
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  transition: background 0.3s, color 0.3s;
}

input, select, button {
  width: 100%;
  padding: 10px;
  margin: 5px 0;
  border-radius: 6px;
  border: 1px solid #ccc;
  transition: all 0.2s;
}

input:focus, select:focus {
  border-color: var(--primary);
  outline: none;
}

button {
  cursor: pointer;
  background: var(--primary);
  color: white;
  border: none;
}

button:hover {
  opacity: 0.9;
}

ul {
  padding-left: 20px;
}

ul li {
  margin: 5px 0;
  list-style-type: disc;
  opacity: 0;
  animation: fadeIn 0.5s forwards;
}

button.small {
  padding: 3px 7px;
  font-size: 12px;
  margin-left: 5px;
}

.hidden { display: none; }

#modeToggle {
  margin-bottom: 20px;
  background: #444;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-5px);}
  to { opacity: 1; transform: translateY(0);}
}
</style>
</head>

<body>

<div class="card" id="login">
<h2>Admin Login</h2>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<div class="hidden" id="panel">

<button id="modeToggle" onclick="toggleMode()">Switch Night/Day Mode</button>

<div class="card">
<h3>Members</h3>
<input id="member" placeholder="Member Name">
<button onclick="addMember()">Add Member</button>
<ul id="list"></ul>
<button onclick="exportMembers()">Export Members CSV</button>
</div>

<div class="card">
<h3>Tasks</h3>
<input id="taskName" placeholder="Task Name">
<select id="priority">
<option>Low</option>
<option selected>Medium</option>
<option>High</option>
</select>
<button onclick="addTask()">Add Task</button>
<ul id="taskList"></ul>
<button onclick="exportTasks()">Export Tasks CSV</button>
</div>

<button onclick="logout()">Logout</button>
</div>

<script>
let members = JSON.parse(localStorage.getItem("members")) || [];
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let darkMode = JSON.parse(localStorage.getItem("darkMode")) || false;

const list = document.getElementById("list");
const taskList = document.getElementById("taskList");

if(darkMode) applyDarkMode();

function login(){
  if(user.value.trim()=="admin" && pass.value.trim()=="1234"){
    document.getElementById("login").classList.add("hidden");
    document.getElementById("panel").classList.remove("hidden");
    renderMembers();
    renderTasks();
  } else alert("Wrong Login");
}

function toggleMode(){
  darkMode = !darkMode;
  localStorage.setItem("darkMode", JSON.stringify(darkMode));
  applyDarkMode();
}

function applyDarkMode(){
  if(darkMode){
    document.body.style.background = "var(--bg-dark)";
    document.body.style.color = "var(--text-dark)";
    document.querySelectorAll(".card").forEach(c=>c.style.background="var(--card-dark)");
  } else {
    document.body.style.background = "var(--bg-light)";
    document.body.style.color = "var(--text-light)";
    document.querySelectorAll(".card").forEach(c=>c.style.background="var(--card-light)");
  }
}

function addMember(){
  const m = document.getElementById("member").value.trim();
  if(m=="") return;
  members.push(m);
  localStorage.setItem("members", JSON.stringify(members));
  renderMembers();
  document.getElementById("member").value="";
}

function renderMembers(){
  list.innerHTML="";
  members.forEach((m,i)=>{
    const li = document.createElement("li");
    li.innerHTML = `${m} <button class="small" onclick="delMember(${i})">X</button>`;
    list.appendChild(li);
  });
}

function delMember(i){
  members.splice(i,1);
  localStorage.setItem("members", JSON.stringify(members));
  renderMembers();
}

function addTask(){
  const name = document.getElementById("taskName").value.trim();
  const prio = document.getElementById("priority").value;
  if(name=="") return;
  tasks.push({name:name,priority:prio,status:"Pending"});
  localStorage.setItem("tasks", JSON.stringify(tasks));
  renderTasks();
  document.getElementById("taskName").value="";
}

function renderTasks(){
  taskList.innerHTML="";
  tasks.forEach((t,i)=>{
    const li = document.createElement("li");
    li.innerHTML = `${t.name} [${t.priority}] <button class="small" onclick="toggleTask(${i})">Toggle</button> <button class="small" onclick="delTask(${i})">X</button>`;
    taskList.appendChild(li);
  });
}

function toggleTask(i){
  tasks[i].status = tasks[i].status=="Pending"?"Completed":"Pending";
  localStorage.setItem("tasks", JSON.stringify(tasks));
  renderTasks();
}

function delTask(i){
  tasks.splice(i,1);
  localStorage.setItem("tasks", JSON.stringify(tasks));
  renderTasks();
}

function exportMembers(){
  let csv = "Member\n" + members.join("\n");
  downloadCSV(csv,"members.csv");
}

function exportTasks(){
  let csv = "Task,Priority,Status\n";
  tasks.forEach(t=> csv += `${t.name},${t.priority},${t.status}\n`);
  downloadCSV(csv,"tasks.csv");
}

function downloadCSV(content,filename){
  const blob = new Blob([content], {type:"text/csv"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
}

function logout(){
  location.reload();
}
</script>

</body>
</html>
